
## BIBLIOTHEQUE ----
# ####################### #

library(shiny)
library(shinythemes)
library(shinydashboard)
library(shinydashboardPlus)
library(lubridate)
library(dplyr)
library(ggplot2)
library(DT)
library(readr)
library(data.table)
library(shinyWidgets)

# ####################### #
## UI ----
# ####################### # 
rm(list = ls())

ui <- dashboardPage(
  dashboardHeader(title = "ELAN INFO", titleWidth = 300),
  dashboardSidebar(collapsed = TRUE,
                   sidebarMenu(id = "tabs",
                               menuItem("Dashboard", tabName = "tab_dashboard", icon = icon("dashboard")),
                               menuItem("Lecture des informations ", tabName = "tab_readData", icon = icon("bar-chart-o")),
                               menuItem("Visualiser des informations", tabName = "tab_visualization", icon = icon("eye")),
                               menuItem("Gestion des familles", tabName = "tab_familles", icon = icon("fas fa-cog"))
                   )
  ),
  body <- dashboardBody(
    tabItems(
      tabItem(tabName = "tab_visualization",
              
              fluidRow(
                column(
                  width = 2, offset = -1,
                  h3("Filtre des ventes"), DTOutput("dataFileSum")
                ),
                column(
                  width = 3, offset = 1,
                  tags$br(),
                  dateRangeInput("DateRange",label = "Selectionner une plage de date :", start = now(), separator = " / "),
                  selectizeInput('SelectCode', 'Selectionner Code Article', choices = " ", multiple = TRUE)
                ),
                column(
                  width = 3, offset = 1,
                  tags$br(),
                  selectizeInput('SelectFamilles', 'Selectionner les familles', choices = " ", multiple = TRUE),
                  selectizeInput('SelectTVA', 'Selectionner la TVA', choices = " ", multiple = TRUE)
                )
              ),
              DTOutput("dataFile")
      ),
            tabItem(
        tabName = "tab_dashboard", 
        h2("Tableau de bord"),
        (actionButton(inputId = "UploadFile", label = "Charger des informations", icon = icon("play"))),
       # shinythemes::themeSelector(),
       tags$br(),
        DTOutput("MyDataBis")
        
      ),
      tabItem(
        tabName = "tab_readData",
        box(title = "Informations d'importation",
            status = "warning",
            fluidRow(
              column(width = 5, offset = 1),
              column(
                width = 9,
                offset = 1,
                radioButtons(
                  inputId = "header",
                  label = "Entete",
                  choices = c("oui"= TRUE, "non"= FALSE),
                  selected = TRUE, inline=T
                ),
                radioButtons(
                  inputId = "sep", 
                  label = "Separateur",
                  choices = c(Virgule = ",",'Point Virgule' = ";",Tabulation = "\t"),
                  selected = ";", 
                  inline=T
                ),
                radioButtons(
                  inputId = "quote",
                  label = "Guillemet",
                  choices = c(Aucun = "","Double Guillemets" = '"',"Single Guillemet" = "'"),
                  selected = "", inline=T
                )
              )
            )
        ),
        box(title = "Informations sur le TPV",
            status = "warning",
            fluidRow(
              column(width = 5, offset = 1),
              column(
                width = 9,
                offset = 1,
                radioButtons(
                  inputId = "marque",
                  label = "Marque",
                  choices = c(Aucun = "","Marques" = '"',"EXA" = "'"),
                  selected = TRUE, inline=T
                )))),
              fluidRow(
                column(
                  width = 3, offset = 1,
                  fileInput("dataFile",label = NULL,buttonLabel = "Navigateur...", placeholder = "Selectionner un fichier"),
                column( 
                  width = 2, offset = 3,
                  (actionButton(inputId = "visualisation", label = "visualiser", icon = icon("play")))),
                 #  tags$br(),
                  h3(""))),
              fluidRow(
                column(
                  width = 12, offset = -1,
                  DTOutput("tab_preview")
                )
              )  
        ),
      tabItem(
        tabName = "tab_familles",
        fluidRow(
          column(
            width = 9,
            offset = -1,
            h3("Gestion des familles")),
          column( 
            width = 3, 
            offset = 1,
            fileInput("dataFamilles",label = "Familles",buttonLabel = "Navigateur...", placeholder = "Selectionner un fichier"),
            actionButton(inputId = "mergingF", label = "utiliser", icon = icon("upload"))   
            ),
          column(
            width = 3, 
            offset = 1,
            fileInput("dataCod.Rayons",label = "Codes Rayons",buttonLabel = "Navigateur...", placeholder = "Selectionner un fichier"),
            actionButton(inputId = "merging", label = "Sauvegarder", icon = icon("upload"))  
         ),
         fluidRow(
           column(
             width = 9, offset = 1,
             tabsetPanel(
               tabPanel("Table des familles", DT::dataTableOutput("dataFamilles") ),
               tabPanel("Table des rayons", DT::dataTableOutput("dataCod.Rayons") )

            )
           )
          )
        )
      )
    )
  ),
  
  skin = c("green")
)
